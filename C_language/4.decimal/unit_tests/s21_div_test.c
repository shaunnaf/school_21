#include <check.h>
#include <float.h>
#include <math.h>
#include <stdio.h>
#include <string.h>

#include "../s21_decimal.h"
static s21_decimal dst[] = {
    {{0x00000001, 0x00000000, 0x00000000, 0x00000000}},  // 1
    {{0x000000FF, 0x00000000, 0x00000000, 0x00000000}},  // 255
    {{0xFFFFFFFF, 0xFFFFFFFF, 0x00000000, 0x00000000}},  // 18446744073709551615
    {{0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF,
      0x00000000}},  // 79228162514264337593543950335
};

static char *div_res[] = {
    "+1",
    "+0.0039215686274509803921568627",
    "+0.0000000000000000000542101086",
    "+0.0000000000000000000000000000",
    "+0.0000000000000000000000000001",
    "+0.0000000000000000000000000000",
    "+0.0000000000000000000000000000",
    "+0.0000000000000000000000000000",
    "+255",
    "+1",
    "+0.0000000000000000138235776992",
    "+0.0000000000000000000000000032",
    "+0.0000000000000000000000000255",
    "+0.0000000000000000000000000001",
    "+0.0000000000000000000000000000",
    "+0.0000000000000000000000000000",
    "+18446744073709551615",
    "+72340172838076673",
    "+1",
    "+0.0000000002328306436538696289",
    "+0.0000000018446744073709551615",
    "+0.0000000000072340172838076673",
    "+0.0000000000000000000000000001",
    "+0.0000000000000000000000000000",
    "+79228162514264337593543950335",
    "+310698676526526814092329217",
    "+4294967296.0000000002328306436",
    "+1",
    "+7.9228162514264337593543950335",
    "+0.0310698676526526814092329217",
    "+0.0000000000000000004294967296",
    "+0.0000000000000000000000000001",
    "+10000000000000000000000000000",
    "+39215686274509803921568627.451",
    "+542101086.24275221703311375920",
    "+0.1262177448353618888658765704",
    "+1",
    "+0.0039215686274509803921568627",
    "+0.0000000000000000000542101086",
    "+0.0000000000000000000000000000",
    "+0.0000000000000000000000000000",
    "+10000000000000000000000000000",
    "+138235776991.90181534344400860",  //??????????????????? нужен ли 0?
    "+32.185524933017281660798525464",
    "+255",
    "+1",
    "+0.0000000000000000138235776992",
    "+0.0000000000000000000000000032",
    "+0.0000000000000000000000000000",
    "+0.0000000000000000000000000000",
    "+10000000000000000000000000000",
    "+2328306436538696288.9362822552",
    "+18446744073709551615",
    "+72340172838076673",
    "+1",
    "+0.0000000002328306436538696289",
    "+0.0000000000000000000000000000",
    "+0.0000000000000000000000000000",
    "+0.0000000000000000000000000000",
    "+10000000000000000000000000000",
    "+79228162514264337593543950335",
    "+310698676526526814092329217",
    "+4294967296.0000000002328306436",
    "+1"};
START_TEST(test_div) {
  s21_decimal dec1 = {0}, dec2 = {0};
  int index = 0;
  for (int x = 1; x >= 0; x--)
    for (size_t i = 0; i < 4; i++) {
      for (int t = 0; t < 4; t++) dec1.bits[t] = dst[i].bits[t];
      if (x) {
        _S_D_(dec1, 28);
      } else {
        _S_D_(dec1, 0);
      }
      for (int y = 1; y >= 0; y--)
        for (size_t j = 0; j < 4; j++) {
          for (int t = 0; t < 4; t++) dec2.bits[t] = dst[j].bits[t];
          if (y) {
            _S_D_(dec2, 28);
          } else {
            _S_D_(dec2, 0);
          }
          s21_decimal res = {0};
          int result = s21_div(dec1, dec2, &res);
          char str_res[100] = {0};
          get_formatted_str_decimal(res, str_res);
          if (!result) {
            ck_assert_pstr_eq(str_res, div_res[index]);
          }
          index++;
        }
    }
}

Suite *suite_div_test(void) {
  Suite *s;
  TCase *tc;

  s = suite_create("s21_div");
  tc = tcase_create("s21_div");

  if (s != NULL && tc != NULL) {
    tcase_add_test(tc, test_div);
    //   tcase_add_test(tc, test1);
    suite_add_tcase(s, tc);
  }

  return (s);
}