#include <check.h>
#include <float.h>
#include <math.h>
#include <stdio.h>
#include <string.h>

#include "../s21_decimal.h"
static s21_decimal dst[] = {
    {{0x00000001, 0x00000000, 0x00000000, 0x00000000}},  // 1
    {{0x000000FF, 0x00000000, 0x00000000, 0x00000000}},  // 255
    {{0xFFFFFFFF, 0xFFFFFFFF, 0x00000000, 0x00000000}},  // 18446744073709551615
    {{0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF,
      0x00000000}},  // 79228162514264337593543950335
};

static char *add_res[] = {"+0.0000000000000000000000000002",
                          "+0.0000000000000000000000000256",
                          "+0.0000000018446744073709551616",
                          "+7.922816251426433759354395034",
                          "+1.0000000000000000000000000001",
                          "+255.00000000000000000000000000",
                          "+18446744073709551615.000000000",
                          "+79228162514264337593543950335",
                          "+0.0000000000000000000000000256",
                          "+0.0000000000000000000000000510",
                          "+0.0000000018446744073709551870",
                          "+7.922816251426433759354395059",
                          "+1.0000000000000000000000000255",
                          "+255.00000000000000000000000002",
                          "+18446744073709551615.000000000",
                          "+79228162514264337593543950335",
                          "+0.0000000018446744073709551616",
                          "+0.0000000018446744073709551870",
                          "+0.0000000036893488147419103230",
                          "+7.922816253271108166725350195",
                          "+1.0000000018446744073709551615",
                          "+255.00000000184467440737095516",
                          "+18446744073709551615.000000002",
                          "+79228162514264337593543950335",
                          "+7.922816251426433759354395034",
                          "+7.922816251426433759354395059",
                          "+7.922816253271108166725350195",
                          "+15.845632502852867518708790067",
                          "+8.922816251426433759354395034",
                          "+262.92281625142643375935439503",
                          "+18446744073709551622.922816251",
                          "+0.0000000000000000000000000000",
                          "+1.0000000000000000000000000001",
                          "+1.0000000000000000000000000255",
                          "+1.0000000018446744073709551615",
                          "+8.922816251426433759354395034",
                          "+2",
                          "+256",
                          "+18446744073709551616",
                          "+0.0000000000000000000000000000",
                          "+255.00000000000000000000000000",
                          "+255.00000000000000000000000002",
                          "+255.00000000184467440737095516",
                          "+262.92281625142643375935439503",
                          "+256",
                          "+510",
                          "+18446744073709551870",
                          "+0.0000000000000000000000000000",
                          "+18446744073709551615.000000000",
                          "+18446744073709551615.000000000",
                          "+18446744073709551615.000000002",
                          "+18446744073709551622.922816251",
                          "+18446744073709551616",
                          "+18446744073709551870",
                          "+36893488147419103230",
                          "+0.0000000000000000000000000000",
                          "+79228162514264337593543950335",
                          "+79228162514264337593543950335",
                          "+79228162514264337593543950335",
                          "+0.0000000000000000000000000000",
                          "+0.0000000000000000000000000000",
                          "+0.0000000000000000000000000000",
                          "+0.0000000000000000000000000000",
                          "+0.0000000000000000000000000000"};
START_TEST(test_add) {
  s21_decimal dec1 = {0}, dec2 = {0};
  int index = 0;
  for (int x = 1; x >= 0; x--)
    for (size_t i = 0; i < 4; i++) {
      for (int t = 0; t < 4; t++) dec1.bits[t] = dst[i].bits[t];
      if (x) {
        _S_D_(dec1, 28);
      } else {
        _S_D_(dec1, 0);
      }
      for (int y = 1; y >= 0; y--)
        for (size_t j = 0; j < 4; j++) {
          for (int t = 0; t < 4; t++) dec2.bits[t] = dst[j].bits[t];
          if (y) {
            _S_D_(dec2, 28);
          } else {
            _S_D_(dec2, 0);
          }
          s21_decimal res = {0};
          int result = s21_add(dec1, dec2, &res);
          char str_res[100] = {0};
          get_formatted_str_decimal(res, str_res);
          if (!result) {
            ck_assert_pstr_eq(str_res, add_res[index]);
          }
          index++;
        }
    }
}

Suite *suite_add_test(void) {
  Suite *s;
  TCase *tc;

  s = suite_create("s21_add");
  tc = tcase_create("s21_add");

  if (s != NULL && tc != NULL) {
    tcase_add_test(tc, test_add);
    //   tcase_add_test(tc, test1);
    suite_add_tcase(s, tc);
  }

  return (s);
}